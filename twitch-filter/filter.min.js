var channels=[],fadeDelay=5E3,showChannel=!0,useColor=!0,showBadges=!0,showEmotes=!0,doTimeouts=!0,doChatClears=!0,showHosting=!0,showConnectionNotices=!0,defaultColors="rgb(255, 0, 0);rgb(0, 0, 255);rgb(0, 128, 0);rgb(178, 34, 34);rgb(255, 127, 80);rgb(154, 205, 50);rgb(255, 69, 0);rgb(46, 139, 87);rgb(218, 165, 32);rgb(210, 105, 30);rgb(95, 158, 160);rgb(30, 144, 255);rgb(255, 105, 180);rgb(138, 43, 226);rgb(0, 255, 127)".split(";"),randomColorsChosen={},clientOptions={options:{debug:!1},channels:channels},
client=new irc.client(clientOptions);function dehash(a){return a.replace(/^#/,"")}function capitalize(a){return a[0].toUpperCase()+a.substr(1)}function htmlEntities(a){var b=Array.isArray(a);b||(a=a.split(""));a=function(){return a.map(function(a,b,d){return 1==a.length?a.replace(/[\u00A0-\u9999<>\&]/gim,function(a){return"&#"+a.charCodeAt(0)+";"}):a})}(a);b||(a=a.join(""));return a}
function formatEmotes(a,b){var c=a.split(""),e;for(e in b){var d=b[e],g;for(g in d){var f=d[g];if("string"==typeof f){var f=f.split("-"),f=[parseInt(f[0]),parseInt(f[1])],k=Array.apply(null,Array(f[1]-f[0]+1)).map(function(){return""}),c=c.slice(0,f[0]).concat(k).concat(c.slice(f[1]+1,c.length));c.splice(f[0],1,'<img class="emoticon" src="http://static-cdn.jtvnw.net/emoticons/v1/'+e+'/3.0">')}}}return htmlEntities(c).join("")}
function badges(a,b,c){function e(a){var b=document.createElement("div");b.className="chat-badge-"+a;return b}var d=document.createElement("span");d.className="chat-badges";c?chatChages.appendChild(e("bot")):(b.username==a&&d.appendChild(e("broadcaster")),b["user-type"]&&d.appendChild(e(b["user-type"])),b.turbo&&d.appendChild(e("turbo")));return d}
function handleChat(a,b,c,e){var d=dehash(a),g=b.username,f=document.createElement("div"),k=document.createElement("span"),l=document.createElement("span"),n=document.createElement("span"),m=document.createElement("span"),h=useColor?b.color:"inherit";null===h&&(randomColorsChosen.hasOwnProperty(d)||(randomColorsChosen[d]={}),randomColorsChosen[d].hasOwnProperty(g)?h=randomColorsChosen[d][g]:(h=defaultColors[Math.floor(Math.random()*defaultColors.length)],randomColorsChosen[d][g]=h));f.className="chat-line";
f.dataset.username=g;f.dataset.channel=a;"action"==b["message-type"]&&(f.className+=" chat-action");k.className="chat-channel";k.innerHTML=d;l.className="chat-name";l.style.color=h;l.innerHTML=b["display-name"]||g;n.className="chat-colon";m.className="chat-message";m.style.color=h;m.innerHTML=showEmotes?formatEmotes(c,b.emotes):htmlEntities(c);1<client.opts.channels.length&&showChannel&&f.appendChild(k);showBadges&&f.appendChild(badges(d,b,e));f.appendChild(l);f.appendChild(n);f.appendChild(m);chat.elem.appendChild(f);
chat.limitMessages();chat.elem.scrollTop=5E3;(a=chat.rateComment(c))&&0<=a&&(chat.selectedFeed.appendChild(f.cloneNode(!0)).title="Comment Score: "+a)}function chatNotice(a,b,c,e){var d=document.createElement("div");d.className="chat-line chat-notice";d.innerHTML=a;void 0!==e&&(Array.isArray(e)&&(e=e.join(" ")),d.className+=" "+e);"number"==typeof c&&0!=c&&(d.dataset.level=c);chat.elem.appendChild(d);"number"==typeof b&&setTimeout(function(){d.dataset.faded=""},b||500);return d}
var recentTimeouts={};
function timeout(a,b){if(!doTimeouts)return!1;recentTimeouts.hasOwnProperty(a)||(recentTimeouts[a]={});if(!recentTimeouts[a].hasOwnProperty(b)||recentTimeouts[a][b]+1E4<+new Date)recentTimeouts[a][b]=+new Date,chatNotice(capitalize(b)+" was timed-out in "+capitalize(dehash(a)),1E3,1,"chat-delete-timeout");var c=document.querySelectorAll('.chat-line[data-channel="'+a+'"][data-username="'+b+'"]:not(.chat-timedout) .chat-message'),e;for(e in c){var d=c[e];"object"==typeof d&&(d.innerText="<Message deleted>",
d.parentElement.className+=" chat-timedout")}}function clearChat(a){if(!doChatClears)return!1;var b=document.querySelectorAll('.chat-line[data-channel="'+a+'"]'),c;for(c in b){var e=b[c];"object"==typeof e&&(e.className+=" chat-cleared")}chatNotice("Chat was cleared in "+capitalize(dehash(a)),1E3,1,"chat-delete-clear")}
function hosting(a,b,c,e){if(!showHosting)return!1;"-"==c&&(c=0);a=dehash(a);a=capitalize(a);e?chatNotice(a+" is no longer hosting.",null,null,"chat-hosting-no"):(b=capitalize(b),chatNotice(a+" is now hosting "+b+" for "+c+" viewer"+(1!==c?"s":"")+".",null,null,"chat-hosting-yes"))}client.addListener("message",handleChat);client.addListener("timeout",timeout);client.addListener("clearchat",clearChat);client.addListener("hosting",hosting);
client.addListener("unhost",function(a,b){hosting(a,null,b,!0)});var joinAccounced=[];client.addListener("connecting",function(a,b){showConnectionNotices&&chatNotice("Connecting",1E3,-4,"chat-connection-good-connecting")});client.addListener("logon",function(){showConnectionNotices&&chatNotice("Authenticating",1E3,-3,"chat-connection-good-logon")});client.addListener("connectfail",function(){showConnectionNotices&&chatNotice("Connection failed",1E3,3,"chat-connection-bad-fail")});
client.addListener("connected",function(a,b){showConnectionNotices&&chatNotice("Connected",1E3,-2,"chat-connection-good-connected");joinAccounced=[]});client.addListener("disconnected",function(a){showConnectionNotices&&chatNotice("Disconnected: "+(a||""),3E3,2,"chat-connection-bad-disconnected")});client.addListener("reconnect",function(){showConnectionNotices&&chatNotice("Reconnected",1E3,"chat-connection-good-reconnect")});
client.addListener("join",function(a,b){-1==joinAccounced.indexOf(a)&&(showConnectionNotices&&chatNotice("Joined "+capitalize(dehash(a)),1E3,-1,"chat-room-join"),joinAccounced.push(a))});client.addListener("part",function(a,b){-1<joinAccounced.indexOf(a)&&(showConnectionNotices&&chatNotice("Parted "+capitalize(dehash(a)),1E3,-1,"chat-room-part"),joinAccounced.splice(joinAccounced.indexOf(a),1))});client.addListener("crash",function(){chatNotice("Crashed",1E4,4,"chat-crash")});
var menu={show:function(){document.getElementById("m").style.display="inherit";document.getElementById("mbg").style.display="inherit"},hide:function(){document.getElementById("m").style.display="none";document.getElementById("mbg").style.display="none"}},chat={init:function(){document.getElementById("channelSelect").style.display="none";var a=document.getElementById("channelInput").value;localStorage.lastChannels=a;channels.push(a);client.connect()}},commentT={username:"Name",colorClass:"",content:"This is a test comment to be used for testing"};
chat.elem=document.getElementById("feed-orig");chat.selectedFeed=document.getElementById("feed-selec");
chat.newComment=function(a){document.getElementById("feed-orig").innerHTML+='<li class="feed-item"><span class="name '+a.colorClass+'">'+a.username+"</span>"+a.content+"</li>";document.getElementById("feed-orig").scrollTop=5E3;var b=chat.rateComment(a);if(b){var c=document.getElementById("feed-selec"),e=c.innerHTML;c.innerHTML=e+('<li class="feed-item" title="Score: '+b+'"><span class="name '+(0<b?"green":"red")+'">'+a.username+"</span>"+a.content+"</li>");document.getElementById("feed-selec").scrollTop=
5E3}chat.limitMessages()};chat.rateComment=function(a){var b=document.getElementById("maxChars").value,c=document.getElementById("minChars").value,e=document.getElementById("minWords").value,d=document.getElementById("allowCaps").value;if(a.length>b||a.length<c||!d&&a===a.toUpperCase()||a.split(" ").length<e||function(a){filteredUsers.forEach(function(b){if(b===a)return!0});return!1}(a.username))return!1;var g=0;keywords.forEach(function(b){-1<a.indexOf(b[0])&&(g+=b[1])});return g};
chat.limitMessages=function(){var a=document.getElementById("maxRecords").value;[document.getElementById("feed-orig"),document.getElementById("feed-selec")].forEach(function(b){if(b.hasChildNodes()&&b.childNodes.length>a)for(var c=b.childNodes.length-a,e=0;e<c;e++)b.removeChild(b.childNodes[0])})};
chat.checkConnection=function(){var a=document.getElementById("s");"undefined"!==typeof socket&&"undefined"!==typeof socket.connected?socket.connected?(a.setAttribute("connection","connected"),a.innerHTML=" Connected"):(a.setAttribute("connection","disconnected"),a.innerHTML=" Disconnected"):(a.setAttribute("connection","fail"),a.innerHTML=" Loading Failed")};
var ui={startResize:function(){ui.colLeft=document.getElementById("col-left");ui.colRight=document.getElementById("col-right");document.onmousemove=ui.resize},endResize:function(){document.onmousemove=null},resize:function(a){ui.colRight.attributes.style.value="width:"+(document.body.clientWidth-a.x)+"px;";ui.colLeft.attributes.style.value="width:"+a.x+"px;"},init:function(){window.onresize=function(a){ui.resize(a)}}};localStorage.lastChannels&&(document.getElementById("channelInput").value=localStorage.lastChannels);
ui.init();